---
title: "WSL2ã¨claspã‚’ç”¨ã„ã¦GASã®ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã‚’æ§‹ç¯‰ã™ã‚‹"
emoji: "ğŸ“š"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["javascript", "GAS", "WSL2"]
published: false
---

# ã¯ã˜ã‚ã«
ã“ã‚“ã«ã¡ã¯ï¼Keichan_15 ã¨ç”³ã—ã¾ã™ã€‚

æ™®æ®µã¯Javaã§AtCoderã«ã‚‚ãŒãè‹¦ã—ã‚“ã ã‚Šã€Railsã‚„GASã€WSL2ã‚’ç”¨ã„ãŸç’°å¢ƒæ§‹ç¯‰ã ã£ãŸã‚Šã‚’ç´°ã€…ã¨ã‚„ã£ã¦ãŠã‚Šã¾ã™ã€‚
Qiitaã§ã„ãã¤ã‹è¨˜äº‹ã‚’åŸ·ç­†ã—ã¦ã„ã‚‹ã®ã§ã™ãŒã€ä»Šå›Zennã§ã‚‚1ã¤è¨˜äº‹ã‚’åŸ·ç­†ã—ã¦ã¿ãŸã„ãªã¨æ€ã„ã€ä»Šã«è‡³ã‚Šã¾ã™â€¦ï¼ˆç¬‘ï¼‰

ã¨ã“ã‚ã§æœ€è¿‘GASã®é­…åŠ›ã«ã©ã£ã·ã‚Šãƒãƒã£ã¦ã—ã¾ã£ã¦ãŠã‚Šã€ä¸­ã€…æŠœã‘å‡ºã›ãšã«ã„ã¾ã™ã€‚GASã®ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ã«ç›´æ¥ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã™ã‚‹ã®ã‚‚è‰¯ã„ã®ã§ã™ãŒã€ã›ã£ã‹ããªã‚‰æ…£ã‚Œè¦ªã—ã‚“ã ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§æ§‹ç¯‰ã—ãŸã„ã‚ˆã­ï½ã£ã¦è¡å‹•ã«é§†ã‚‰ã‚Œã€WSL2ã¨claspã‚’ç”¨ã„ãŸç’°å¢ƒæ§‹ç¯‰ã‚’è¡Œã£ãŸã®ã§ãã®å‚™å¿˜éŒ²ã«ãªã‚Šã¾ã™ï¼

ãã‚Œã§ã¯æ—©é€Ÿè¦‹ã¦ã„ãã¾ã—ã‚‡ã†ï½ï¼ã‚ˆã‚ã—ããŠé¡˜ã„ã—ã¾ã™ï¼(Â´â–½ï½€*)

# äº‹å‰æº–å‚™
ä»Šå›ã¯ã€ **WSL2ãŒå°å…¥æ¸ˆã§ã‚ã‚‹ã“ã¨ã‚’å‰æ** ã¨ã—ã¦é€²ã‚ã¦ã„ãã¾ã™ã€‚WSLã®å°å…¥æ–¹æ³•ã«ã¤ã„ã¦ã¯è‡ªèº«ãŒéå»ã«åŸ·ç­†ã—ãŸè¨˜äº‹ã‚’ã”è¦§ã„ãŸã ã‘ã¾ã™ã¨å¹¸ã„ã§ã™ã€‚

https://qiita.com/Keichan_15/items/15548f1bdef2503a08b7

è¨˜äº‹å†…ã§å°å…¥ã™ã‚‹é …ç›®ã®ã†ã¡ã€è¡Œã£ã¦é ‚ããŸã„é …ç›®ã¯ä»¥ä¸‹ã®2ã¤ã«ãªã‚Šã¾ã™ã€‚

- **WSL2ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«**
- **Node.jsã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«**

ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒå®Œäº†ã—ãŸã‚‰æ—©é€Ÿclaspã‚’å°å…¥ã—ã¦ã„ãã¾ã—ã‚‡ã†ï¼

# å°å…¥
## å®Ÿè¡Œç’°å¢ƒã®æ§‹ç¯‰
ã¾ãšã€ä»»æ„ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆã—ã¾ã™ã€‚ä»Šå›ã¯ ``clasp_demo`` ã¨ã„ã†ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆã—ã¾ã™ã€‚ä½œæˆãŒå®Œäº†ã—ãŸã‚‰åŒæ™‚ã«ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚‚ç§»å‹•ã—ã¦ãŠãã¾ã—ã‚‡ã†ã€‚

```terminal:Ubuntu
$ mkdir clasp_demo
$ cd clasp_demo
```

ã¤ã„ã§ã«ã€ä»¥é™ã¯VSCodeã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚’ä½¿ç”¨ã—ã¦å°å…¥ã‚’è¡Œã†ãŸã‚ã€è¿½åŠ ã§ä¸‹è¨˜ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å…¥åŠ›ã—ã¾ã™ã€‚

```terminal:Ubuntu
$ code .
```
ã“ã®ã‚³ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã™ã‚‹ã“ã¨ã§VSCodeã®æ‹¡å¼µæ©Ÿèƒ½ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚

æ¬¡ã«ã€å¿µã®ãŸã‚Node.jsã¨npmãŒå°å…¥ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã—ã¾ã™ã€‚

```terminal:Ubuntu
$ node --version
v16.17.0

$ npm --version
8.15.0
```

è‹¥å¹²è¡¨ç¤ºã•ã‚Œã‚‹ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®é•ã„ã¯ã‚ã‚‹ã‹ã¨æ€ã„ã¾ã™ãŒã€ã“ã®ã‚ˆã†ã«è¡¨ç¤ºã•ã‚Œã¦ã„ã‚Œã°å•é¡Œã‚ã‚Šã¾ã›ã‚“ã€‚

## Google Apps Script APIã®æœ‰åŠ¹åŒ–
claspã‚’ä½¿ç”¨ã™ã‚‹ãŸã‚ã«Google Apps Script APIã‚’æœ‰åŠ¹åŒ–ã«ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
ä¸‹è¨˜ã®ãƒšãƒ¼ã‚¸ã‹ã‚‰æœ‰åŠ¹åŒ–ã—ã¾ã—ã‚‡ã†ã€‚

https://script.google.com/home/usersettings


![](https://storage.googleapis.com/zenn-user-upload/a04b7fc99bf8-20230316.png)

![](https://storage.googleapis.com/zenn-user-upload/ca5611f5bf9f-20230316.png)

## ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®å°å…¥
æ¬¡ã«å¿…è¦ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã„ãã¾ã™ã€‚

```:Ubuntu
$ npm init -y
$ npm install @google/clasp -g
$ npm install @types/google-apps-script
```
ã¡ãªã¿ã«åƒ•ã¯ã“ã“ã§ã‚³ã‚±ã¾ã—ãŸã€‚2ã¤ç›®ã®ã‚³ãƒãƒ³ãƒ‰ã§ã‚ã‚‹ `clasp` ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ä¸‹è¨˜ã®ã‚¨ãƒ©ãƒ¼ã«ã¶ã¡å½“ãŸã‚Šã¾ã™ã€‚

```:Ubuntu
npm notice
npm notice New major version of npm available! 8.15.0 -> 9.6.2
npm notice Changelog: https://github.com/npm/cli/releases/tag/v9.6.2
npm notice Run npm install -g npm@9.6.2 to update!
npm notice
npm ERR! code EACCES
npm ERR! syscall rename
npm ERR! path /usr/local/lib/node_modules/@google/clasp
npm ERR! dest /usr/local/lib/node_modules/@google/.clasp-L3XGxwFD
npm ERR! errno -13
npm ERR! Error: EACCES: permission denied, rename '/usr/local/lib/node_modules/@google/clasp' -> '/usr/local/lib/node_modules/@google/.clasp-L3XGxwFD'
npm ERR!  [Error: EACCES: permission denied, rename '/usr/local/lib/node_modules/@google/clasp' -> '/usr/local/lib/node_modules/@google/.clasp-L3XGxwFD'] {
npm ERR!   errno: -13,
npm ERR!   code: 'EACCES',
npm ERR!   syscall: 'rename',
npm ERR!   path: '/usr/local/lib/node_modules/@google/clasp',
npm ERR!   dest: '/usr/local/lib/node_modules/@google/.clasp-L3XGxwFD'
npm ERR! }
npm ERR!
npm ERR! The operation was rejected by your operating system.
npm ERR! It is likely you do not have the permissions to access this file as the current user
npm ERR!
npm ERR! If you believe this might be a permissions issue, please double-check the
npm ERR! permissions of the file and its containing directories, or try running
npm ERR! the command again as root/Administrator.

npm ERR! A complete log of this run can be found in:
npm ERR!     /home/keichan/.npm/_logs/2023-03-16T12_19_13_632Z-debug-0.log
```
ã‚ã‚Œï½ã¨æ€ã£ãŸã®ã§ã™ãŒã€ã‚ˆãã‚ˆããƒ­ã‚°ã‚’è¦‹ã¦ã¿ã‚‹ã¨ã€

```
npm ERR! errno -13
npm ERR! Error: EACCES: permission denied, rename '/usr/local/lib/node_modules/@google/clasp' -> '/usr/local/lib/node_modules/@google/.clasp-L3XGxwFD'
npm ERR!  [Error: EACCES: permission denied, rename '/usr/local/lib/node_modules/@google/clasp' -> '/usr/local/lib/node_modules/@google/.clasp-L3XGxwFD'] 
```

`permission denied` ã®æ–‡å­—ãŒã‚ã‚‹ã§ã¯ãªã„ã‹ï¼ã¨ã„ã†ã“ã¨ã§ã€ `sudo` ã§å®Ÿè¡Œã™ã‚‹ã¨å•é¡Œç„¡ãé€šã‚Šã¾ã—ãŸã€‚

```:Ubuntu
$ npm init -y
$ sudo npm install @google/clasp -g
$ sudo npm install @types/google-apps-script
```

ä½™è«‡ã§ã™ãŒã€npmã®updateé€šçŸ¥ãŒå…¥ã£ã¦ã„ã¾ã—ãŸã®ã§ä¸€ç·’ã«ã‚„ã£ã¦ãŠãã¾ã—ãŸã€‚

```:Ubuntu
npm notice New major version of npm available! 8.15.0 -> 9.6.2
npm notice Changelog: https://github.com/npm/cli/releases/tag/v9.6.2
npm notice Run npm install -g npm@9.6.2 to update!
```

```:Ubuntu
$ sudo npm install -g npm@9.6.2
$ npm --version
9.6.2
```

![](https://storage.googleapis.com/zenn-user-upload/0a5c8eecfa8e-20230320.png)

## Googleã‚¢ã‚«ã‚¦ãƒ³ãƒˆé€£æº
ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®å°å…¥ãŒå®Œäº†ã—ãŸã‚‰Googleã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¨é€£æºã—ã¾ã™ã€‚ä¸‹è¨˜ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚

```:Ubuntu
$ clasp login
Warning: You seem to already be logged in *globally*. You have a ~/.clasprc.json
Logging in globallyâ€¦
ğŸ”‘ Authorize clasp by visiting this url:
https://accounts.google.com/o/oauth2/v2/auth?access_type=xxxxxoxxxox
```
ãŠãã‚‰ãè‡ªå‹•ã§Google ChromeãŒé–‹ãã¨æ€ã„ã¾ã™ã€‚ç”»é¢ã®èª¬æ˜ã«æ²¿ã£ã¦ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’é¸æŠã—ã¦é€£æºã—ã¾ã™ã€‚

![](https://storage.googleapis.com/zenn-user-upload/dc3f41d0ff5f-20230321.jpg)

![](https://storage.googleapis.com/zenn-user-upload/e48b0010ae58-20230321.jpg)

è¦‹åˆ‡ã‚Œã¦ã„ã¾ã™ãŒã€ä¸‹ã«ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã™ã‚‹ã¨ `è¨±å¯` ã®ãƒœã‚¿ãƒ³ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã¨æ€ã„ã¾ã™ã€‚

![](https://storage.googleapis.com/zenn-user-upload/90281579e56e-20230321.png)

è¨±å¯ãŒé€šã‚Šä¸‹è¨˜ã®ã‚ˆã†ãªç”»é¢ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã¨OKã§ã™ï¼

![](https://storage.googleapis.com/zenn-user-upload/f738475dccfc-20230321.png)

ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã«ã‚‚ä¸‹è¨˜ã®ã‚ˆã†ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã¨æ€ã„ã¾ã™ã€‚

```:Ubuntu
Authorization successful.
```

## ä½œæˆ
æº–å‚™ãŒå®Œäº†ã—ãŸã®ã§GASã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æ–°è¦ä½œæˆã—ã¦ã„ãã¾ã—ã‚‡ã†ï¼

```:Ubuntu
$ clasp create
? Create which script? (Use arrow keys)
â¯ standalone 
  docs 
  sheets 
  slides 
  forms 
  webapp 
  api 
```

`clasp create` ã‚’å…¥åŠ›ã—ãŸå¾Œã€ã©ã®å½¢å¼ã§GASã‚’ä½œæˆã™ã‚‹ã‹é¸æŠã§ãã¾ã™ã€‚ä»Šå›ã¯ `standalone` ã‚’é¸æŠã—ã¾ã™ã€‚

```:Ubuntu
$ clasp create
? Create which script? standalone
Created new standalone script: https://script.google.com/d/1B-_zRnoWU3poLHaUhEzUn0q5IAKxJwE3vkBvPVpJTkmmIBfFird0w72j/edit
Warning: files in subfolder are not accounted for unless you set a '/home/keichan/clasp_demo/.claspignore' file.
Cloned 1 file.
â””â”€ /home/keichan/clasp_demo/appsscript.json
```

ã“ã‚Œã§ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®æº–å‚™ãŒã§ãã¾ã—ãŸã€‚
æ¬¡ã«ä»Šå›ã¯ãƒ†ã‚¹ãƒˆã§ `main.js` ã‚’ä½œæˆã—ã€`Hello World` ã‚’ãƒ­ã‚°å‡ºåŠ›ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè£…ã—ã¦ã„ãã¾ã™ã€‚

ã¾ãšã€ `main.js` ã‚’ä½œæˆã—ã¾ã™ã€‚


